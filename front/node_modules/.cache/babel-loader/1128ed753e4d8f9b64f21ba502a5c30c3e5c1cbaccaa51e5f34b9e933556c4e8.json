{"ast":null,"code":"export const storageService = {\n  query,\n  get,\n  post,\n  put,\n  remove\n};\nfunction query(entityType) {\n  let delay = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 500;\n  var entities = JSON.parse(localStorage.getItem(entityType)) || [];\n  return new Promise(resolve => setTimeout(() => resolve(entities), delay));\n}\nfunction get(entityType, entityId) {\n  return query(entityType).then(entities => {\n    const entity = entities.find(entity => entity._id === entityId);\n    if (!entity) throw new Error(`Get failed, cannot find entity with id: ${entityId} in: ${entityType}`);\n    return entity;\n  });\n}\nfunction post(entityType, newEntity) {\n  newEntity = JSON.parse(JSON.stringify(newEntity));\n  newEntity._id = _makeId();\n  return query(entityType).then(entities => {\n    entities.push(newEntity);\n    _save(entityType, entities);\n    return newEntity;\n  });\n}\nfunction put(entityType, updatedEntity) {\n  updatedEntity = JSON.parse(JSON.stringify(updatedEntity));\n  return query(entityType).then(entities => {\n    const idx = entities.findIndex(entity => entity._id === updatedEntity._id);\n    if (idx < 0) throw new Error(`Update failed, cannot find entity with id: ${updatedEntity._id} in: ${entityType}`);\n    entities.splice(idx, 1, updatedEntity);\n    _save(entityType, entities);\n    return updatedEntity;\n  });\n}\nfunction remove(entityType, entityId) {\n  return query(entityType).then(entities => {\n    const idx = entities.findIndex(entity => entity._id === entityId);\n    if (idx < 0) throw new Error(`Remove failed, cannot find entity with id: ${entityId} in: ${entityType}`);\n    entities.splice(idx, 1);\n    _save(entityType, entities);\n  });\n}\n\n// Private functions\n\nfunction _save(entityType, entities) {\n  localStorage.setItem(entityType, JSON.stringify(entities));\n}\nfunction _makeId() {\n  let length = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 5;\n  var text = '';\n  var possible = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';\n  for (var i = 0; i < length; i++) {\n    text += possible.charAt(Math.floor(Math.random() * possible.length));\n  }\n  return text;\n}","map":{"version":3,"names":["storageService","query","get","post","put","remove","entityType","delay","entities","JSON","parse","localStorage","getItem","Promise","resolve","setTimeout","entityId","then","entity","find","_id","Error","newEntity","stringify","_makeId","push","_save","updatedEntity","idx","findIndex","splice","setItem","length","text","possible","i","charAt","Math","floor","random"],"sources":["C:/Users/user/Desktop/CycleUp/front/src/services/async-storage.service.js"],"sourcesContent":["export const storageService = {\r\n    query,\r\n    get,\r\n    post,\r\n    put,\r\n    remove,\r\n}\r\n\r\nfunction query(entityType, delay = 500) {\r\n    var entities = JSON.parse(localStorage.getItem(entityType)) || []\r\n    return new Promise(resolve => setTimeout(() => resolve(entities), delay))\r\n}\r\n\r\nfunction get(entityType, entityId) {\r\n    return query(entityType).then(entities => {\r\n        const entity = entities.find(entity => entity._id === entityId)\r\n        if (!entity) throw new Error(`Get failed, cannot find entity with id: ${entityId} in: ${entityType}`)\r\n        return entity\r\n    })\r\n}\r\n\r\nfunction post(entityType, newEntity) {\r\n    newEntity = JSON.parse(JSON.stringify(newEntity))    \r\n    newEntity._id = _makeId()\r\n    return query(entityType).then(entities => {\r\n        entities.push(newEntity)\r\n        _save(entityType, entities)\r\n        return newEntity\r\n    })\r\n}\r\n\r\nfunction put(entityType, updatedEntity) {\r\n    updatedEntity = JSON.parse(JSON.stringify(updatedEntity))    \r\n    return query(entityType).then(entities => {\r\n        const idx = entities.findIndex(entity => entity._id === updatedEntity._id)\r\n        if (idx < 0) throw new Error(`Update failed, cannot find entity with id: ${updatedEntity._id} in: ${entityType}`)\r\n        entities.splice(idx, 1, updatedEntity)\r\n        _save(entityType, entities)\r\n        return updatedEntity\r\n    })\r\n}\r\n\r\nfunction remove(entityType, entityId) {\r\n    return query(entityType).then(entities => {\r\n        const idx = entities.findIndex(entity => entity._id === entityId)\r\n        if (idx < 0) throw new Error(`Remove failed, cannot find entity with id: ${entityId} in: ${entityType}`)\r\n        entities.splice(idx, 1)\r\n        _save(entityType, entities)\r\n    })\r\n}\r\n\r\n// Private functions\r\n\r\nfunction _save(entityType, entities) {\r\n    localStorage.setItem(entityType, JSON.stringify(entities))\r\n}\r\n\r\n\r\nfunction _makeId(length = 5) {\r\n    var text = ''\r\n    var possible = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789'\r\n    for (var i = 0; i < length; i++) {\r\n        text += possible.charAt(Math.floor(Math.random() * possible.length))\r\n    }\r\n    return text\r\n}\r\n\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}